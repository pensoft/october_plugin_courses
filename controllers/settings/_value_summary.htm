<?php
// Determine if value is a scalar (simple) value or complex (JSON)
$isJson = is_array($record->value) || is_object($record->value);
$isScalar = is_scalar($record->value) || is_null($record->value);
$jsonValue = false;

// Try to parse as JSON if it's a string
if (is_string($record->value) && !$isScalar) {
    $jsonValue = json_decode($record->value, true);
    $isJson = is_array($jsonValue) && json_last_error() === JSON_ERROR_NONE;
}

// Display appropriate format
if ($isScalar) {
    // For scalars, just show the value directly
    echo e(str_limit((string)$record->value, 100));
} elseif ($isJson) {
    // For JSON, show a summary
    $valueToDisplay = $jsonValue ?: $record->value;
    
    if (is_array($valueToDisplay)) {
        if (count($valueToDisplay) > 0) {
            echo '<span class="text-info">JSON Object</span> ';
            echo '(' . count($valueToDisplay) . ' items)';
        } else {
            echo '<span class="text-muted">Empty Array</span>';
        }
    } else {
        echo '<span class="text-info">Complex Value</span>';
    }
} else {
    echo '<span class="text-muted">Unknown Value Type</span>';
}
?> 